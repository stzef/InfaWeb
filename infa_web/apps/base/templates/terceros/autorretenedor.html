{%extends 'layouts/base.html'%}

{%block content%}
	{%include 'elements/nav.html'%}
	{%include 'elements/sidebar.html'%}
	<div class="content-wrapper" style="min-height: 921px;">
	<section class="content">
		<div class="row">
			<div class="col-md-12">

				<div class="box box-primary">
					<div class="box-header with-border">
						<h3 class="box-title">Nuevo Tipo de Identificacion</h3>
					</div>
					<form action="" method="POST" role="form" class="form-horizontal">
						{%csrf_token%}
						<div class="box-body">
							<section class="row col-md-12">
								<div class="form-group">
									<label for="{{form.nautorre.id_for_label}}" class="col-sm-2 control-label">{{form.nautorre.label}}</label>
									{%if form.nautorre.errors%}
									{{form.nautorre.errors}}
									{%endif%}
									<div class="col-sm-10">
										{{form.nautorre}}
									</div>
								</div>
							</section>
							<div class="btn-group">
								<button class="btn btn-app btn-info" type="submit">
									<i class="fa fa-plus-square-o"></i>Guardar
								</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</section>
	</div>
	{%include 'elements/footer.html'%}
{%endblock%}

{% block content_script %}
	<script>
			$("form").submit(function(event){
				event.preventDefault()
				$.ajax({
					{% if mode_view == "edit" %}
						url: '{% url 'edit-autorretenedor' current_pk %}',
					{% elif mode_view == "create" %}
						url: '{% url 'add-autorretenedor' %}',
					{% else %}
						url: '',
					{% endif %}
					type: 'POST',
					data: $("form").serialize(),
					contentType: "application/x-www-form-urlencoded",
					success: function(response){
						var object = JSON.parse(response.object)[0]
						var fields = object.fields
						if(window.opener){
							window.opener.$("select[name=cautorre")
								.append($("<option>",{value:response.pk,html:fields.nautorre}).attr("selected",true))
								.focus()
							window.close()
						}
					}
				});
			})
	</script>
{% endblock %}
